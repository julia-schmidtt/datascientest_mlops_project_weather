groups:
  - name: model-quality
    rules:
      - alert: ModelQualityLow
        expr: model_f1_score < 0.6
        for: 5s
        labels:
          severity: warning
        annotations:
          summary: "Model F1 score dropped below 60%."
          description: |
            The model F1 score is below 60% for more than 5 seconds.
            Current value: {{ $value }}
  
  - name: api-latency
    rules:
      - alert: APIEndpointHighLatency
        expr: |
          histogram_quantile(
            0.95,
            sum by (le, endpoint) (
              rate(
                api_request_duration_seconds_bucket{
                  endpoint=~"/predict|/predict/simple|/model/info|/model/refresh"
                }[5m]
              )
            )
          ) > 2
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High latency on API endpoint {{ $labels.endpoint }}"
          description: |
            The p95 response time for endpoint {{ $labels.endpoint }}
            is above 2 seconds for more than 2 minutes.
            Current p95 latency: {{ $value }} seconds.
